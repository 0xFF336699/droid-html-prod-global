{"version":3,"file":"static/chunks/pages/action-list/app-selector-9b03060e7c870b66.js","mappings":"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","sources":["webpack://_N_E/?0d1e","webpack://_N_E/../../libs/droid/android/src/android/scripts/readAllPackages.ts","webpack://_N_E/./src/pages/action-list/app-selector/index.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/action-list/app-selector\",\n      function () {\n        return require(\"private-next-pages/action-list/app-selector/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/action-list/app-selector\"])\n      });\n    }\n  ","\r\nimport { IPackageInfo, appPackagesStore } from \"@app/static\";\r\nimport { autoWebViewJs } from \"../\";\r\nimport { isRealInAndroid } from \"../is-in-android\";\r\n// import { readAllPackagesMockData } from \"./mock-data/readAllPackages\";\r\nconst script = `com.fanfanlo.droid.js.JsReceiver.readAllPackages();`\r\n\r\nfunction readAllPackages():IPackageInfo[]{\r\n    let res = autoWebViewJs.callScript<IPackageInfo[]>(script);\r\n    const list =  (res.javaResultData || []) as IPackageInfo[]\r\n    appPackagesStore.savePackages(list)\r\n    return list\r\n}\r\nasync function mockReadAllPackages():Promise<IPackageInfo[]>{\r\n    const list = [\r\n        {\r\n            label: \"test\",\r\n            iconBase64: \"test\",\r\n            packageName: \"test\"\r\n        }\r\n    ]\r\n\r\n    // if(appPackagesStore.data.list.length > 0)return appPackagesStore.data.list\r\n    const mockData = await import('./mock-data/readAllPackages')\r\n    appPackagesStore.savePackages(mockData.readAllPackagesMockData as IPackageInfo[])\r\n    return mockData.readAllPackagesMockData\r\n}\r\n\r\nexport const readAllPackagesScript = {\r\n    script,\r\n    readAllPackages: isRealInAndroid ? readAllPackages : mockReadAllPackages,\r\n}\r\n","import { ActionOrTriggerListTypeEnum, appPackagesStore, IActionOrTriggerListPageParams, IPackageInfo, routerUtils } from \"@app/static\";\r\nimport { readAllPackagesScript } from \"@droid/android/\";\r\nimport { proxyWatch, storeUtils, throwTraceError, toProxy, useProxyWatch, useTranslation } from \"@fanfanlo\";\r\nimport RefreshIcon from '@mui/icons-material/Refresh';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport { alpha, Box, Grid2, IconButton, InputBase, List, ListItem, ListItemText, styled, Tab, Tabs } from \"@mui/material\";\r\nimport { useRouter } from \"next/router\";\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { AppbarContainer, AppShell } from \"@app/ui\";\r\nimport { getTriggerOrActionListPageParams, ProjectMemberType } from \"@droid/project-interface\";\r\nimport { actionOpenAppUtils, getActionUtils, IActionOpenAppData } from \"@droid/project-interface\";\r\nimport { projectEventUtils } from \"@droid/project-interface\";\r\nconst storeName = 'app-selector'\r\nconst storage = storeUtils.namespace(storeName)\r\nconst storeRecentlyPackageListKey = 'recentlyPackageList'\r\n\r\nenum TabEnum {\r\n  all = \"all\",\r\n  recently = \"recently\"\r\n}\r\ninterface IPageProps {\r\n  searchKey?: string\r\n  packageList: IPackageInfo[]\r\n  showPackageList: IPackageInfo[]\r\n  recentlyPackageList: IPackageInfo[]\r\n  tab: TabEnum\r\n  onPackageSelect: (packageInfo: IPackageInfo) => void\r\n}\r\n\r\nconst PageContext = createContext<IPageProps>({\r\n  packageList: [],\r\n  showPackageList: [],\r\n  recentlyPackageList: [],\r\n  tab: TabEnum.all,\r\n  onPackageSelect: (packageInfo: IPackageInfo) => { }\r\n})\r\nfunction useController() {\r\n  const router = useRouter()\r\n  const nowPath = router.pathname;\r\n  function onPackageSelect(packageInfo: IPackageInfo) {\r\n    addRecentlyPackage(packageInfo)\r\n    handlePackageSelect(packageInfo)\r\n  }\r\n\r\n  function handlePackageSelect(packageInfo: IPackageInfo) {\r\n    const query = router.query as IActionOrTriggerListPageParams\r\n    switch (query.type) {\r\n      case ActionOrTriggerListTypeEnum.addAction:\r\n        {\r\n          const res = getTriggerOrActionListPageParams(query)\r\n          if (!res.data.actionGroup) {\r\n            console.error('actionGroup is undefined query=', query, 'packageInfo=', packageInfo)\r\n            throw new Error('actionGroup is undefined')\r\n          }\r\n          if(!query.actionType){\r\n            return throwTraceError(`actionType is undefined query=${query}`, query, packageInfo)\r\n          }\r\n          // const utils = ActionUtilsMap[query.actionType]\r\n          const utils = getActionUtils<IActionOpenAppData>(query.actionType)\r\n          if (!utils) throw new Error(`actionType ${query.actionType} is not found`)\r\n          const action = utils.createDefultData()\r\n          switch (query.actionType) {\r\n            case actionOpenAppUtils.type:\r\n              action.javaData.packageName = packageInfo.packageName\r\n              break\r\n            default:\r\n              throw new Error(`actionType ${query.actionType} is not found`)\r\n          }\r\n          // projectEventUtils.dispatchAddEvent(action.type, ProjectMemberType.actionGroup, action, res)\r\n\r\n          projectEventUtils.dispatchEditEvent(projectEventUtils.EditType.add, {\r\n            projectMemberType:ProjectMemberType.actionGroup,\r\n            data:action,\r\n            projectInfo:res.data\r\n          })\r\n          // res.data.actionGroup.list.push(action)\r\n          routerUtils.checkToPath(router, nowPath, query.backPath!, 2)\r\n          // router.back()\r\n          // router.back()\r\n          break\r\n        }\r\n      case ActionOrTriggerListTypeEnum.updateAction: {\r\n        const res = getTriggerOrActionListPageParams(query)\r\n        console.log('res', res)\r\n        if (!res.data.actionGroup) {\r\n          console.error('actionGroup is undefined query=', query, 'packageInfo=', packageInfo)\r\n          throw new Error('actionGroup is undefined')\r\n        }\r\n        if(!res.data.action){\r\n          console.error( `action is undefined query= `, query, `packageinfo=`, packageInfo)\r\n          throw new Error(`action is undefined`)\r\n        }\r\n\r\n          projectEventUtils.dispatchEditEvent(projectEventUtils.EditType.updateJavaData, {\r\n            projectMemberType:ProjectMemberType.action,\r\n            data:{packageName:packageInfo.packageName},\r\n            projectInfo:res.data\r\n          })\r\n        console.log('dispatch event232323456')\r\n        switch (query.actionType) {\r\n          case actionOpenAppUtils.type:\r\n            // const action: IActionOpenAppData = res.data.action as IActionOpenAppData\r\n            // action.javaData.packageName = packageInfo.packageName\r\n            router.back()\r\n            break\r\n          default:\r\n            throw new Error(`actionType ${query.actionType} is not found`)\r\n        }\r\n        break\r\n      }\r\n\r\n    }\r\n  }\r\n  function addRecentlyPackage(packageInfo: IPackageInfo) {\r\n    const index = props.recentlyPackageList.findIndex(item => item.packageName === packageInfo.packageName)\r\n    if (index !== -1) {\r\n      props.recentlyPackageList.splice(index, 1)\r\n    }\r\n    props.recentlyPackageList.unshift(packageInfo)\r\n    storage.write(storeRecentlyPackageListKey, props.recentlyPackageList)\r\n  }\r\n  const props = toProxy<IPageProps>({\r\n    packageList: [],\r\n    showPackageList: [],\r\n    recentlyPackageList: storage.read(storeRecentlyPackageListKey) || [],\r\n    tab: TabEnum.all,\r\n    onPackageSelect\r\n  })\r\n  proxyWatch(props, 'tab', (v, old) => {\r\n    updateShowPackageList()\r\n  })\r\n  proxyWatch(props, 'searchKey', (v, old) => {\r\n    updateShowPackageList()\r\n  })\r\n  function updateShowPackageList() {\r\n    props.showPackageList = [...getShowPackageList()]\r\n  }\r\n  function getTabShowPackageList() {\r\n    if (props.tab === TabEnum.all) {\r\n      return props.packageList\r\n    } else if (props.tab === TabEnum.recently) {\r\n      return props.recentlyPackageList\r\n    }\r\n    throw new Error(\"tab is not valid\")\r\n  }\r\n  function getShowPackageList() {\r\n    const list = getTabShowPackageList()\r\n    if (props.searchKey) {\r\n      return list.filter(item => item.label.includes(props.searchKey!!))\r\n    }\r\n    return list\r\n  }\r\n\r\n  proxyWatch(props, 'searchKey', (v, old) => {\r\n    updateShowPackageList()\r\n  })\r\n\r\n  proxyWatch<{ list: IPackageInfo[] }, IPackageInfo[]>(appPackagesStore.data, 'list', (v, old) => {\r\n    props.packageList = [...appPackagesStore.data.list]\r\n    updateShowPackageList()\r\n  })\r\n  useEffect(() => {\r\n    if (props.packageList.length > 0) return //不为空则跳出\r\n    appPackagesStore.loadPackages()//从缓存读取\r\n    if (appPackagesStore.data.list.length > 0) return //缓存不为空则跳出\r\n    readAllPackagesScript.readAllPackages()//从安卓读取\r\n  }, [])\r\n  updateShowPackageList()\r\n  return [props]\r\n}\r\nfunction AppList() {\r\n  const pageProps = useContext(PageContext)\r\n  const [list] = useProxyWatch<IPageProps, IPackageInfo[]>(pageProps, 'showPackageList', pageProps.showPackageList)\r\n  return (\r\n    <Box>\r\n      <List>\r\n        {list.map((item, index) => (\r\n          <ListItem key={index} onClick={() => pageProps.onPackageSelect(item)}>\r\n            <Grid2 container>\r\n              <Grid2 size=\"grow\" container\r\n              data-id=\"app-selector-893f\">\r\n                <img width={30}\r\n                  style={{ borderRadius: '8px' }}\r\n                  src={`data:image/gif;base64,${item.iconBase64}`}\r\n                />\r\n                <ListItemText primary={item.label} />\r\n              </Grid2>\r\n            </Grid2>\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n    </Box>\r\n  )\r\n}\r\n\r\n\r\nfunction AccessibleTabs() {\r\n  const [value, setValue] = useState(0);\r\n  const { t } = useTranslation(\"homepage/pages/action-list/app-selector/content\")\r\n  const handleChange = (event: React.SyntheticEvent, newValue: number) => {\r\n    setValue(newValue);\r\n    pageProps.tab = newValue === 0 ? TabEnum.all : TabEnum.recently\r\n  };\r\n  const pageProps = useContext(PageContext)\r\n  return (\r\n    <Box sx={{ width: '100%' }}>\r\n      <Tabs sx={{ width: '100%' }}\r\n        onChange={handleChange}\r\n        value={value}\r\n        aria-label=\"Tabs where selection follows focus\"\r\n        selectionFollowsFocus\r\n      >\r\n        <Tab sx={{ width: '50%' }} label={t(\"content.all\")} />\r\n        <Tab sx={{ width: '50%' }} label={t(\"content.recently\")} />\r\n      </Tabs>\r\n    </Box>\r\n  );\r\n}\r\n\r\nconst Search = styled('div')(({ theme }) => ({\r\n  position: 'relative',\r\n  borderRadius: theme.shape.borderRadius,\r\n  backgroundColor: alpha(theme.palette.common.white, 0.15),\r\n  '&:hover': {\r\n    backgroundColor: alpha(theme.palette.common.white, 0.25),\r\n  },\r\n  marginLeft: 0,\r\n  width: '100%',\r\n  [theme.breakpoints.up('sm')]: {\r\n    marginLeft: theme.spacing(1),\r\n    width: 'auto',\r\n  },\r\n}));\r\n\r\nconst SearchIconWrapper = styled('div')(({ theme }) => ({\r\n  padding: theme.spacing(0, 2),\r\n  height: '100%',\r\n  position: 'absolute',\r\n  pointerEvents: 'none',\r\n  display: 'flex',\r\n  alignItems: 'center',\r\n  justifyContent: 'center',\r\n}));\r\n\r\nconst StyledInputBase = styled(InputBase)(({ theme }) => ({\r\n  color: 'inherit',\r\n  width: '100%',\r\n  '& .MuiInputBase-input': {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n    // vertical padding + font size from searchIcon\r\n    paddingLeft: `calc(1em + ${theme.spacing(4)})`,\r\n    transition: theme.transitions.create('width'),\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: '12ch',\r\n      '&:focus': {\r\n        width: '20ch',\r\n      },\r\n    },\r\n  },\r\n}));\r\n\r\nfunction Title() {\r\n  const { t } = useTranslation(\"homepage/pages/action-list/app-selector/content\")\r\n  const pageProps = useContext(PageContext)\r\n  function onSeachChange(e: React.ChangeEvent<HTMLInputElement>) {\r\n    pageProps.searchKey = e.target.value\r\n  }\r\n  return (\r\n    <Grid2 container width={\"100%\"} justifyContent={\"space-between\"}\r\n      sx={{ alignItems: \"center\" }}>\r\n      <Grid2>\r\n\r\n        <Search>\r\n          <SearchIconWrapper>\r\n            <SearchIcon />\r\n          </SearchIconWrapper>\r\n          <StyledInputBase\r\n            onChange={onSeachChange}\r\n            placeholder={t(\"content.searchPlaceholder\")}\r\n            inputProps={{ 'aria-label': 'search' }}\r\n          />\r\n        </Search>\r\n      </Grid2>\r\n      <Grid2>\r\n        <IconButton onClick={() => {\r\n          readAllPackagesScript.readAllPackages()\r\n        }}>\r\n          <RefreshIcon />\r\n        </IconButton>\r\n\r\n      </Grid2>\r\n    </Grid2>\r\n  )\r\n}\r\nexport default function AppSelector() {\r\n  const [props] = useController()\r\n  return (\r\n    <AppShell>\r\n      <PageContext.Provider value={props}>\r\n        <AppbarContainer\r\n        titleConf={{ns:\"homepage/pages/action-list/app-selector/content\", key:\"content.title\"}}\r\n        appbarProps={{\r\n          title: <Title />,\r\n          back: true,\r\n      }}>\r\n        <AccessibleTabs />\r\n        <AppList />\r\n      </AppbarContainer>\r\n    </PageContext.Provider>\r\n    </AppShell>\r\n  )\r\n}\r\n\r\n\r\n"],"names":["appPackagesStore","autoWebViewJs","isRealInAndroid","script","readAllPackages","res","callScript","list","javaResultData","savePackages","mockReadAllPackages","label","iconBase64","packageName","mockData","readAllPackagesMockData","readAllPackagesScript","ActionOrTriggerListTypeEnum","routerUtils","proxyWatch","storeUtils","throwTraceError","toProxy","useProxyWatch","useTranslation","RefreshIcon","SearchIcon","alpha","Box","Grid2","IconButton","InputBase","List","ListItem","ListItemText","styled","Tab","Tabs","useRouter","createContext","useContext","useEffect","useState","AppbarContainer","AppShell","getTriggerOrActionListPageParams","ProjectMemberType","actionOpenAppUtils","getActionUtils","projectEventUtils","storeName","storage","namespace","storeRecentlyPackageListKey","TabEnum","PageContext","packageList","showPackageList","recentlyPackageList","tab","onPackageSelect","packageInfo","useController","router","nowPath","pathname","addRecentlyPackage","handlePackageSelect","query","type","addAction","data","actionGroup","console","error","Error","actionType","utils","action","createDefultData","javaData","dispatchEditEvent","EditType","add","projectMemberType","projectInfo","checkToPath","backPath","updateAction","log","updateJavaData","back","index","props","findIndex","item","splice","unshift","write","read","v","old","updateShowPackageList","getShowPackageList","getTabShowPackageList","searchKey","filter","includes","length","loadPackages","AppList","pageProps","map","onClick","container","size","data-id","img","width","style","borderRadius","src","primary","AccessibleTabs","value","setValue","t","handleChange","event","newValue","sx","onChange","aria-label","selectionFollowsFocus","Search","theme","position","shape","backgroundColor","palette","common","white","marginLeft","breakpoints","up","spacing","SearchIconWrapper","padding","height","pointerEvents","display","alignItems","justifyContent","StyledInputBase","color","paddingLeft","transition","transitions","create","Title","onSeachChange","e","target","placeholder","inputProps","AppSelector","Provider","titleConf","ns","key","appbarProps","title"],"sourceRoot":"","ignoreList":[]}