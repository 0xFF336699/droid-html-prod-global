{"version":3,"file":"static/chunks/pages/markets-dev-settings-2d43347233b8c961.js","mappings":"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B,WAAW6B,IAAI,CAACC,gBAAgB;AACxE;AACO,MAAMkB,sBAAsB;IAC/B9B;IACAE;IACAhB;IACAe;IACAE;IACAuB;IACA7C;AACJ,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnH8B;AACI;AACX;AACqB;AACsB;AACZ;AACT;AACc;AACD;AACT;AAC4D;AAC3C;AACnB;AAChD,qBAAqB,8BAAW;AAChC;AACA,qCAAqC,yBAAY;AACjD;AACA;AACA;AACA,CAAC;AACD;AACA,SAAS,gCAAmB;AAC5B;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,cAAc;AACtC;AACA;AACA;AACA,+BAA+B,kBAAkB;AACjD,0BAA0B,MAAM;AAChC,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACO;AACP;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,OAAO,yCAAiB;AACxB;AACA,KAAK,EAAE,+CAAuB;AAC9B;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,wBAAwB,sCAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA,KAAK,IAAI;AACT,4BAA4B,+CAAuB;AACnD;AACA;AACA,KAAK;AACL,0BAA0B,+CAAuB;AACjD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,eAAe,4BAAQ;AACvB;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA,oBAAoB,sFAAsF,IAAI,4BAAQ;AACtH;AACA;AACA;AACA,aAAa,4BAAS,SAAS,yCAAiB;AAChD;AACA,KAAK;AACL;AACA,WAAW,+CAAuB;AAClC;AACA;AACe,iCAAiC;AAChD;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,WAAW,iCAAc,gBAAgB,wCAAoB,yBAAyB;AACtF;AACA;AACA,6BAA6B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C3BC;IACAyD;IACAJ;AACJ,EAAC;;;;;;;;;;;;;AC7MD;AACA;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC,eAAe,4DAA4D;AAC5E;AACA;AACA,IAAI;AACJ;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,CAAC;AACD,UAAU,sBAAsB;AAChC,WAAW;AACX,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,oBAAoB,GAAG;AACrC;AACA;AACA;AACA;AACA,0BAA0B,eAAe;AACzC,qBAAqB;AACrB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,IAAI;AACJ;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B,iBAAiB,oCAAoC;AACrD;AACA;AACA;AACA;AACA,0BAA0B,oCAAoC;AAC9D;AACA;AACA;AACA;AACA;AACA,wBAAwB,oFAAoF;AAC5G;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,UAAU,yBAAyB,OAAO,2BAA2B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,gCAAgC;AAC7C;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B,4BAA4B,WAAW;AACvC;AACA;AACA,gBAAgB,yBAAyB;AACzC;AACA;AACA,gBAAgB,YAAY;AAC5B,iBAAiB,oCAAoC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,oCAAoC;AACjD;AACA,UAAU,8DAA8D;AACxE,8IAA8I,uBAAuB,MAAM,qBAAqB;AAChM;AACA;AACA,0BAA0B,EAAE;AAC5B;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","sources":["webpack://_N_E/../../libs/fanfanlo/src/react/createTypedContext.ts","webpack://_N_E/./src/markets/markets-script-dev-lib.ts","webpack://_N_E/../../node_modules/.pnpm/@mui+system@6.4.12_@emotion+react@11.14.0_@types+react@19.1.8_react@19.1.0__@emotion+styled@1_sfs2vjcbuqchwdpqpmkla22opm/node_modules/@mui/system/esm/Stack/createStack.js","webpack://_N_E/../../node_modules/.pnpm/@mui+material@6.4.12_@emotion+react@11.14.0_@types+react@19.1.8_react@19.1.0__@emotion+styled_7n6ip7adzgskiknwagt7k5dnla/node_modules/@mui/material/Stack/Stack.js","webpack://_N_E/../../libs/fanfanlo/src/utils/socket/socket-utils.ts","webpack://_N_E/../../libs/fanfanlo/src/react/ContextWrapper.tsx","webpack://_N_E/../../libs/app/ui/src/components/app/AppPageDataWrapperShell.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/data/context.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/content/DevSettings.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/content/Scripts.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/content/MarketsDevSettingsContent.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/data/data.intf.ts","webpack://_N_E/./src/pages/markets-dev-settings/index.tsx","webpack://_N_E/../../markets/market-lib/src/types/market.intf.ts","webpack://_N_E/./src/markets/market-dev-socket-setting-data.ts","webpack://_N_E/./src/markets/market-html-utils.ts","webpack://_N_E/../../node_modules/.pnpm/@open-iframe-resizer+core@1.6.0/node_modules/@open-iframe-resizer/core/dist/index.js","webpack://_N_E/?5529","webpack://_N_E/./src/markets/market-dev-socket.ts","webpack://_N_E/../../libs/app/static/src/mc/static-model.ts","webpack://_N_E/../../libs/app/ui/src/components/motion/page-transition.tsx","webpack://_N_E/../../libs/app/ui/src/components/app/PageShell.tsx","webpack://_N_E/../../libs/app/ui/src/components/appbar/AppBar.tsx"],"sourcesContent":["import { createContext, useContext } from \"react\";\n\nexport function createTypedContext<T>() {\n  const Context = createContext<T | undefined>(undefined);\n  const useTypedContext = () => {\n    const value = useContext(Context);\n    if (value === undefined) throw new Error(\"Context not provided\");\n    return value;\n  };\n  return [Context.Provider, useTypedContext] as const;\n}\n\n\n","import { autoJsStoreUtils } from \"@droid/android\"\r\nimport { IStoreWithData, storeUtils, toProxy } from \"@fanfanlo\"\r\nimport { IAndroidWatchFile, IMarketDevConnectEventType, IMarketDevGetAllEventData, IMarketDevServerEventType, WatchResourceType } from \"@market/lib\"\r\nimport { marketsDevSocket } from \"./market-dev-socket\"\r\nimport { objectCountUtils } from \"@fanfanlo\"\r\ninterface IMarketDevLibInfo{\r\n    allMarketLibData?:IMarketDevGetAllEventData\r\n    \r\n}\r\n// 注意marketDevLibData的操作是由devLibInfo来做的\r\n// 一定保持它俩操作的对象是同一个。\r\nconst marketDevLibData = toProxy<IMarketDevLibInfo>({})\r\nlet devLibInfo:IStoreWithData<IMarketDevLibInfo>// = storeUtils.getNamespaceStoreWithData('devLibInfo', {defData:{}, forceReset:false});\r\n\r\nfunction getMarketScriptDataNsPrefix() {\r\n    return 'market-script-data'\r\n}\r\n\r\nfunction createMarketScriptDataNsPath(ns: string) {\r\n    return `${getMarketScriptDataNsPrefix()}/${ns}`\r\n}\r\n\r\nasync function writeNsAllFiles(ns: string, files: Record<string, string>) {\r\n    const nsPath = createMarketScriptDataNsPath(ns)\r\n    const oldFiles = autoJsStoreUtils.read<string[]>(nsPath) || [];\r\n    for (const name of Object.keys(files)) {\r\n        const index = oldFiles.indexOf(name);\r\n        if (index > -1) {\r\n            oldFiles.splice(index, 1);\r\n        }\r\n        const content = files[name]\r\n        autoJsStoreUtils.write(`${nsPath}/${name}`, content)\r\n    }\r\n    for (const name of oldFiles) {\r\n        removeFile(`${nsPath}/${name}`)\r\n    }\r\n}\r\n\r\nfunction writeFile(name: string, content: string) {\r\n\r\n}\r\n\r\nfunction readNsAllFiles(ns: string) {\r\n\r\n}\r\n\r\nfunction readFile(name: string) {\r\n\r\n}\r\n\r\nfunction removeFile(name: string) {\r\n\r\n}\r\n\r\nfunction getAllMarkets() {\r\n\r\n}\r\nfunction listenDev(){\r\n    marketsDevSocket.dispatcher.addListener(IMarketDevConnectEventType.getAllScripts, onGetAllScript)\r\n    marketsDevSocket.dispatcher.addListener(IMarketDevServerEventType.update, onFileUpdate)    \r\n}\r\n\r\nfunction onGetAllScript(data:IMarketDevGetAllEventData){\r\n    // console.log('onGetAllScript=2', data)\r\n    // console.log('devLibInfo.data=', devLibInfo.data)\r\n    devLibInfo.data.allMarketLibData = data;\r\n    // 转为已经代理过的对象\r\n    marketDevLibData.allMarketLibData = devLibInfo.data.allMarketLibData;\r\n    // console.log('from onGetAllScript look look id', objectCountUtils.getObjectCount(devLibInfo.data.allMarketLibData.resources))\r\n}\r\n\r\nfunction onFileUpdate(data:IAndroidWatchFile){\r\n    if(data.client.resourceType == WatchResourceType.Html){\r\n        if(!devLibInfo.data.allMarketLibData)return;\r\n        for(const html of devLibInfo.data.allMarketLibData.htmls){\r\n            if(html.client.path == data.client.path){\r\n                html.content = data.content;\r\n                return;\r\n            }\r\n        }\r\n    }else if(data.client.resourceType == WatchResourceType.Js){\r\n        if(!devLibInfo.data.allMarketLibData)return;\r\n        for(let index = 0; index < devLibInfo.data.allMarketLibData.resources.length; index ++){\r\n            const script = devLibInfo.data.allMarketLibData.resources[index];\r\n            if(script.client.path == data.client.path){\r\n                devLibInfo.data.allMarketLibData.resources[index] = data;\r\n                console.log('market script dev scripts update script', data)\r\n                // devLibInfo.data.allMarketLibData.resources = [...devLibInfo.data.allMarketLibData.resources];\r\n                // console.log('update data', data);\r\n                // console.log('look look id', objectCountUtils.getObjectCount(devLibInfo.data.allMarketLibData.resources), devLibInfo.data.allMarketLibData.resources)\r\n                return;\r\n            }\r\n        }\r\n    }else{\r\n        // unknown resource type\r\n    }\r\n}\r\nlet isInitialized = false;\r\nasync function init() {\r\n    if(isInitialized){\r\n        return;\r\n    }\r\n    isInitialized = true;\r\n    listenDev();\r\n    devLibInfo = await storeUtils.getNamespaceStoreWithData('devLibInfo', {defData:{}, forceReset:false});\r\n    marketDevLibData.allMarketLibData = devLibInfo.data.allMarketLibData\r\n}\r\nexport const marketsDevScriptLib = {\r\n    writeFile,\r\n    readFile,\r\n    writeNsAllFiles,\r\n    readNsAllFiles,\r\n    getAllMarkets,\r\n    init,\r\n    marketDevLibData,\r\n}\r\n","import * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport deepmerge from '@mui/utils/deepmerge';\nimport generateUtilityClass from '@mui/utils/generateUtilityClass';\nimport composeClasses from '@mui/utils/composeClasses';\nimport systemStyled from \"../styled/index.js\";\nimport useThemePropsSystem from \"../useThemeProps/index.js\";\nimport { extendSxProp } from \"../styleFunctionSx/index.js\";\nimport createTheme from \"../createTheme/index.js\";\nimport { handleBreakpoints, mergeBreakpointsInOrder, resolveBreakpointValues } from \"../breakpoints/index.js\";\nimport { createUnarySpacing, getValue } from \"../spacing/index.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst defaultTheme = createTheme();\n// widening Theme to any so that the consumer can own the theme structure.\nconst defaultCreateStyledComponent = systemStyled('div', {\n  name: 'MuiStack',\n  slot: 'Root',\n  overridesResolver: (props, styles) => styles.root\n});\nfunction useThemePropsDefault(props) {\n  return useThemePropsSystem({\n    props,\n    name: 'MuiStack',\n    defaultTheme\n  });\n}\n\n/**\n * Return an array with the separator React element interspersed between\n * each React node of the input children.\n *\n * > joinChildren([1,2,3], 0)\n * [1,0,2,0,3]\n */\nfunction joinChildren(children, separator) {\n  const childrenArray = React.Children.toArray(children).filter(Boolean);\n  return childrenArray.reduce((output, child, index) => {\n    output.push(child);\n    if (index < childrenArray.length - 1) {\n      output.push(/*#__PURE__*/React.cloneElement(separator, {\n        key: `separator-${index}`\n      }));\n    }\n    return output;\n  }, []);\n}\nconst getSideFromDirection = direction => {\n  return {\n    row: 'Left',\n    'row-reverse': 'Right',\n    column: 'Top',\n    'column-reverse': 'Bottom'\n  }[direction];\n};\nexport const style = ({\n  ownerState,\n  theme\n}) => {\n  let styles = {\n    display: 'flex',\n    flexDirection: 'column',\n    ...handleBreakpoints({\n      theme\n    }, resolveBreakpointValues({\n      values: ownerState.direction,\n      breakpoints: theme.breakpoints.values\n    }), propValue => ({\n      flexDirection: propValue\n    }))\n  };\n  if (ownerState.spacing) {\n    const transformer = createUnarySpacing(theme);\n    const base = Object.keys(theme.breakpoints.values).reduce((acc, breakpoint) => {\n      if (typeof ownerState.spacing === 'object' && ownerState.spacing[breakpoint] != null || typeof ownerState.direction === 'object' && ownerState.direction[breakpoint] != null) {\n        acc[breakpoint] = true;\n      }\n      return acc;\n    }, {});\n    const directionValues = resolveBreakpointValues({\n      values: ownerState.direction,\n      base\n    });\n    const spacingValues = resolveBreakpointValues({\n      values: ownerState.spacing,\n      base\n    });\n    if (typeof directionValues === 'object') {\n      Object.keys(directionValues).forEach((breakpoint, index, breakpoints) => {\n        const directionValue = directionValues[breakpoint];\n        if (!directionValue) {\n          const previousDirectionValue = index > 0 ? directionValues[breakpoints[index - 1]] : 'column';\n          directionValues[breakpoint] = previousDirectionValue;\n        }\n      });\n    }\n    const styleFromPropValue = (propValue, breakpoint) => {\n      if (ownerState.useFlexGap) {\n        return {\n          gap: getValue(transformer, propValue)\n        };\n      }\n      return {\n        // The useFlexGap={false} implement relies on each child to give up control of the margin.\n        // We need to reset the margin to avoid double spacing.\n        '& > :not(style):not(style)': {\n          margin: 0\n        },\n        '& > :not(style) ~ :not(style)': {\n          [`margin${getSideFromDirection(breakpoint ? directionValues[breakpoint] : ownerState.direction)}`]: getValue(transformer, propValue)\n        }\n      };\n    };\n    styles = deepmerge(styles, handleBreakpoints({\n      theme\n    }, spacingValues, styleFromPropValue));\n  }\n  styles = mergeBreakpointsInOrder(theme.breakpoints, styles);\n  return styles;\n};\nexport default function createStack(options = {}) {\n  const {\n    // This will allow adding custom styled fn (for example for custom sx style function)\n    createStyledComponent = defaultCreateStyledComponent,\n    useThemeProps = useThemePropsDefault,\n    componentName = 'MuiStack'\n  } = options;\n  const useUtilityClasses = () => {\n    const slots = {\n      root: ['root']\n    };\n    return composeClasses(slots, slot => generateUtilityClass(componentName, slot), {});\n  };\n  const StackRoot = createStyledComponent(style);\n  const Stack = /*#__PURE__*/React.forwardRef(function Grid(inProps, ref) {\n    const themeProps = useThemeProps(inProps);\n    const props = extendSxProp(themeProps); // `color` type conflicts with html color attribute.\n    const {\n      component = 'div',\n      direction = 'column',\n      spacing = 0,\n      divider,\n      children,\n      className,\n      useFlexGap = false,\n      ...other\n    } = props;\n    const ownerState = {\n      direction,\n      spacing,\n      useFlexGap\n    };\n    const classes = useUtilityClasses();\n    return /*#__PURE__*/_jsx(StackRoot, {\n      as: component,\n      ownerState: ownerState,\n      ref: ref,\n      className: clsx(classes.root, className),\n      ...other,\n      children: divider ? joinChildren(children, divider) : children\n    });\n  });\n  process.env.NODE_ENV !== \"production\" ? Stack.propTypes /* remove-proptypes */ = {\n    children: PropTypes.node,\n    direction: PropTypes.oneOfType([PropTypes.oneOf(['column-reverse', 'column', 'row-reverse', 'row']), PropTypes.arrayOf(PropTypes.oneOf(['column-reverse', 'column', 'row-reverse', 'row'])), PropTypes.object]),\n    divider: PropTypes.node,\n    spacing: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string])), PropTypes.number, PropTypes.object, PropTypes.string]),\n    sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object])\n  } : void 0;\n  return Stack;\n}","'use client';\n\nimport PropTypes from 'prop-types';\nimport { createStack } from '@mui/system';\nimport styled from \"../styles/styled.js\";\nimport { useDefaultProps } from \"../DefaultPropsProvider/index.js\";\nconst Stack = createStack({\n  createStyledComponent: styled('div', {\n    name: 'MuiStack',\n    slot: 'Root',\n    overridesResolver: (props, styles) => styles.root\n  }),\n  useThemeProps: inProps => useDefaultProps({\n    props: inProps,\n    name: 'MuiStack'\n  })\n});\nprocess.env.NODE_ENV !== \"production\" ? Stack.propTypes /* remove-proptypes */ = {\n  // ┌────────────────────────────── Warning ──────────────────────────────┐\n  // │ These PropTypes are generated from the TypeScript type definitions. │\n  // │    To update them, edit the d.ts file and run `pnpm proptypes`.     │\n  // └─────────────────────────────────────────────────────────────────────┘\n  /**\n   * The content of the component.\n   */\n  children: PropTypes.node,\n  /**\n   * The component used for the root node.\n   * Either a string to use a HTML element or a component.\n   */\n  component: PropTypes.elementType,\n  /**\n   * Defines the `flex-direction` style property.\n   * It is applied for all screen sizes.\n   * @default 'column'\n   */\n  direction: PropTypes.oneOfType([PropTypes.oneOf(['column-reverse', 'column', 'row-reverse', 'row']), PropTypes.arrayOf(PropTypes.oneOf(['column-reverse', 'column', 'row-reverse', 'row'])), PropTypes.object]),\n  /**\n   * Add an element between each child.\n   */\n  divider: PropTypes.node,\n  /**\n   * Defines the space between immediate children.\n   * @default 0\n   */\n  spacing: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string])), PropTypes.number, PropTypes.object, PropTypes.string]),\n  /**\n   * The system prop, which allows defining system overrides as well as additional CSS styles.\n   */\n  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object]),\n  /**\n   * If `true`, the CSS flexbox `gap` is used instead of applying `margin` to children.\n   *\n   * While CSS `gap` removes the [known limitations](https://mui.com/joy-ui/react-stack/#limitations),\n   * it is not fully supported in some browsers. We recommend checking https://caniuse.com/?search=flex%20gap before using this flag.\n   *\n   * To enable this flag globally, follow the [theme's default props](https://mui.com/material-ui/customization/theme-components/#default-props) configuration.\n   * @default false\n   */\n  useFlexGap: PropTypes.bool\n} : void 0;\nexport default Stack;","import validator from \"validator\";\r\nimport { loadI18nValue } from \"../../i18n\";\r\nexport function isValidWebSocketURL(url: string): boolean {\r\n    if(!url)return false;\r\n    return validator.isURL(url, { protocols: ['ws','wss'], require_protocol: true });\r\n  }\r\n  \r\n\r\nexport enum SocketConnectStatusEnum {\r\n    connecting = \"connecting\",\r\n    connected = \"connected\",\r\n    disconnecting = \"disconnecting\",\r\n    disconnected = \"disconnected\",\r\n    waitRetry = \"waitRetry\"\r\n}\r\n\r\nexport async function getSocketConnectStatusEnumI18n(status:SocketConnectStatusEnum){\r\n    return await loadI18nValue('fanfanlo/utils/socket/content', `status.${status}`);\r\n}","\"use client\";\nimport { ReactNode } from \"react\";\n\nexport type ContextWrapperProps<T> = {\n  contextValue: T;\n  ContextProvider: React.ComponentType<{ value: T; children: ReactNode }>;\n  children: ReactNode;\n};\n\nexport function ContextWrapper<T>({ contextValue, ContextProvider, children }: ContextWrapperProps<T>) {\n  return <ContextProvider value={contextValue}>{children}</ContextProvider>;\n}\n","import { PropsWithChildren } from \"react\";\r\nimport { AppShell } from \"./AppShell\";\r\nimport { ContextWrapper, ContextWrapperProps } from \"@fanfanlo\";\r\n\r\n//回头想想AppShell里的s要怎么用\r\n// createTypedContext方法返回的context没想好怎么样跟s结合使用。\r\n\r\nexport function AppPageDataWrapperShell<T>({ children, contextValue, ContextProvider }: PropsWithChildren & ContextWrapperProps<T>) {\r\n    return (\r\n        <AppShell>\r\n            <ContextWrapper contextValue={contextValue} ContextProvider={ContextProvider}>\r\n                {children}\r\n            </ContextWrapper>\r\n        </AppShell>\r\n    )\r\n}","import { createTypedContext } from \"@fanfanlo\";\r\nimport { IPageData } from \"./data.intf\";\r\n\r\nexport const [MarketsDevSettingsContextProvider, useMarketsDevSettingsContext] = createTypedContext<IPageData>();","'use client'\r\nimport { getSocketConnectStatusEnumI18n, isValidWebSocketURL, SocketConnectStatusEnum, useProxyWatch, useTranslation } from \"@fanfanlo\";\r\nimport { Box, Button, Checkbox, FormControlLabel, Grid2, Stack, TextField } from \"@mui/material\";\r\nimport { marketsDevSocket } from \"@src/markets/market-dev-socket\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useMarketsDevSettingsContext } from \"../data/context\";\r\n\r\nfunction URL() {\r\n    const { t } = useTranslation('homepage/components/page/markets-dev-settings/content/content');\r\n    const pageData = useMarketsDevSettingsContext()\r\n    const [value, _setValue] = useState(pageData.socketSettingData.url)\r\n    const [isWrong, setIsWrong] = useState(!isValidWebSocketURL(value))\r\n    function setValue(v: string) {\r\n        _setValue(v)\r\n        pageData.socketSettingData.url = v\r\n        if (!isValidWebSocketURL(v)) {\r\n            setIsWrong(true)\r\n        } else {\r\n            setIsWrong(false)\r\n        }\r\n    }\r\n    const s = t(\"DevSettings.socket.url.helperText\", { 0: \"socket\", 1: \"ws\", 2: \"wss\", 3: \"url\" })\r\n    return (\r\n        <Box>\r\n            <TextField fullWidth\r\n                error={isWrong}\r\n                label={t(\"DevSettings.socket.url.name\")}\r\n                value={value}\r\n                placeholder={\"ws://192.168.1.2:7001\"}\r\n                helperText={isWrong ? s : \"\"}\r\n                variant=\"standard\"\r\n                onChange={(e) => setValue(e.target.value)}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\n\r\nfunction ConnectButton2() {\r\n    const pageData = useMarketsDevSettingsContext()\r\n    const [status] = useProxyWatch(marketsDevSocket.socketConnectInfo, 'status', marketsDevSocket.socketConnectInfo.status);\r\n    const [buttonName, setButtonName] = useState('')\r\n    const { t } = useTranslation('homepage/components/page/markets-dev-settings/content/content');\r\n    const [url] = useProxyWatch(pageData.socketSettingData, 'url', pageData.socketSettingData.url);\r\n    const [enabled, setEnabled] = useState(false)\r\n    useEffect(() => {\r\n        setEnabled((status === SocketConnectStatusEnum.disconnected || status === SocketConnectStatusEnum.connected) && isValidWebSocketURL(url))\r\n    }, [status, url])\r\n    useEffect(() => {\r\n        async function updateButtonName() {\r\n            const status = marketsDevSocket.socketConnectInfo.status\r\n            let name = buttonName;\r\n\r\n            switch (status) {\r\n                case SocketConnectStatusEnum.connecting:\r\n                    name = await getSocketConnectStatusEnumI18n(SocketConnectStatusEnum.connecting)\r\n                    break;\r\n                case SocketConnectStatusEnum.connected:\r\n                    name = t(\"DevSettings.connectButton.disconnect\")\r\n                    break;\r\n                case SocketConnectStatusEnum.disconnecting:\r\n                    name = await getSocketConnectStatusEnumI18n(SocketConnectStatusEnum.disconnecting)\r\n                    break;\r\n                case SocketConnectStatusEnum.disconnected:\r\n                    name = t(\"DevSettings.connectButton.connect\")\r\n                    break;\r\n            }\r\n            if(marketsDevSocket.socketConnectInfo.status !== status){\r\n                return updateButtonName();\r\n            }\r\n            if(name !== buttonName){\r\n                setButtonName(name)\r\n            }\r\n        }\r\n        updateButtonName()\r\n    }, [status])\r\n    function onClick() {\r\n        if (status === SocketConnectStatusEnum.disconnected) {\r\n            marketsDevSocket.connect();\r\n        } else {\r\n            marketsDevSocket.disconnect();\r\n        }\r\n    }\r\n    return (\r\n        <Button\r\n            variant=\"contained\"\r\n            disabled={!enabled}\r\n            onClick={onClick}\r\n        >\r\n            {buttonName}\r\n        </Button>\r\n    )\r\n}\r\n\r\nfunction KeepConnectCheckbox() {\r\n    const pageData = useMarketsDevSettingsContext()\r\n    const [keepConnect] = useProxyWatch(pageData.socketSettingData, 'keepConnect', pageData.socketSettingData.keepConnect ?? false);\r\n    const { t } = useTranslation('homepage/components/page/markets-dev-settings/content/content');\r\n    return (\r\n        \r\n        <FormControlLabel control={<Checkbox\r\n            checked={keepConnect}\r\n            onChange={(e) => pageData.socketSettingData.keepConnect = e.target.checked}\r\n        />}\r\n            label={<span><span>{t(\"DevSettings.socket.keepConnect.name\")}</span><span style={{fontSize:'0.8rem', color:'gray'}}>{t(\"DevSettings.socket.keepConnect.helperText\")}</span></span>}>\r\n\r\n        </FormControlLabel>\r\n    )\r\n}\r\n\r\nfunction CheckboxButtonGroup() {\r\n    return (\r\n        <Grid2 container direction={\"row\"} spacing={2}>\r\n            <Grid2 size={\"grow\"}>\r\n                <KeepConnectCheckbox />\r\n            </Grid2>\r\n            <Grid2 size={\"auto\"}>\r\n                <ConnectButton2 />\r\n            </Grid2>\r\n        </Grid2>\r\n    )\r\n}\r\n\r\nexport function DevSettings() {\r\n    const pageData = useMarketsDevSettingsContext()\r\n    useEffect(() => {\r\n        if(pageData.socketSettingData.keepConnect){\r\n            marketsDevSocket.connect();\r\n        }\r\n    }, [])\r\n    return (\r\n        <>\r\n            <Box>\r\n                <Stack direction={\"column\"} spacing={2}>\r\n                    <URL />\r\n                    <CheckboxButtonGroup />\r\n                </Stack>\r\n            </Box>\r\n        </>\r\n    )\r\n}","import { IFrameReactContainer, useProxyWatchUpdates } from \"@fanfanlo\";\r\nimport { IAndroidWatchFile } from \"@market/lib\";\r\nimport { Box, Stack } from \"@mui/material\";\r\nimport { marketHtmlUtils } from \"@src/markets/market-html-utils\";\r\nimport { marketsDevScriptLib } from \"@src/markets/markets-script-dev-lib\";\r\n\r\nfunction createHtml(script:string){\r\n    // return marketHtmlUtils.createHtml(script);\r\n    return `<html>\r\n    <head>\r\n        <title>script</title>\r\n    </head>\r\n    <body>\r\n        <div id=\"app\"></div>\r\n        <script>${script}</script>\r\n    </body>\r\n</html>`\r\n}\r\nfunction Script({resource}:{resource:IAndroidWatchFile}){\r\n    return(\r\n        <Box>\r\n            <Stack direction=\"column\" spacing={2}>\r\n                <span>{resource.client.path}</span>\r\n                {/* <IFrameReactContainer content={createHtml(resource.content)} /> */}\r\n                <IFrameReactContainer content={resource.content} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            </Stack>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport function Scripts(){\r\n    const [resources] = useProxyWatchUpdates(marketsDevScriptLib.marketDevLibData, \"allMarketLibData.resources\", marketsDevScriptLib.marketDevLibData.allMarketLibData?.resources || []);\r\n    return(\r\n        <Box>\r\n            {\r\n                marketsDevScriptLib.marketDevLibData.allMarketLibData?.resources?.map((resource, index)=>{\r\n                    return(\r\n                        <Script key={resource.content} resource={resource} />\r\n                    )\r\n                })\r\n            }\r\n        </Box>\r\n    )\r\n}","import { Box } from \"@mui/material\";\r\nimport { DevSettings } from \"./DevSettings\";\r\nimport { Scripts } from \"./Scripts\";\r\n\r\n\r\n\r\n\r\nexport function MarketsDevSettingsContent(){\r\n    return(\r\n        <>\r\n            <Box>\r\n                <DevSettings />\r\n                <Scripts />\r\n                <Box>\r\n                    <button>hello</button>\r\n                </Box>\r\n            </Box>\r\n        </>\r\n    )\r\n}","import { toProxy } from \"@fanfanlo\";\r\nimport { getMarketDevSocketSettingData } from \"@src/markets/market-dev-socket-setting-data\";\r\n\r\nexport interface ISocketSettingData{\r\n    //如果点击开始链接了，那就保持链接，这样需要注意不在开发环境时会不停重连。\r\n    keepConnect:boolean;\r\n    url:string;\r\n}\r\n\r\nexport interface IPageData{\r\n    socketSettingData:ISocketSettingData;\r\n}\r\n\r\nasync function createDefPageData():Promise<IPageData>{\r\n    return {\r\n        socketSettingData:await getMarketDevSocketSettingData()\r\n    }\r\n}\r\n\r\nlet dataImpl:IPageData|undefined\r\nexport async function marketsDevSettingsLoadDefData():Promise<IPageData>{\r\n    if(dataImpl){\r\n        return dataImpl;\r\n    }\r\n    let data:IPageData = await createDefPageData();\r\n    dataImpl = toProxy(data);\r\n    return dataImpl;\r\n}","import { AppbarContainer, AppPageDataWrapperShell } from \"@app/ui\";\r\nimport { autoWebViewJs } from \"@droid/android\";\r\nimport { Dispatcher, isValidWebSocketURL, useTranslation } from \"@fanfanlo\";\r\nimport { IScriptConf } from \"@market/lib\";\r\nimport { Box, Button } from \"@mui/material\";\r\nimport { MarketsDevSettingsContent } from \"@src/components/page/markets-dev-settings/content/MarketsDevSettingsContent\";\r\nimport { MarketsDevSettingsContextProvider } from \"@src/components/page/markets-dev-settings/data/context\";\r\nimport { IPageData, marketsDevSettingsLoadDefData } from \"@src/components/page/markets-dev-settings/data/data.intf\";\r\nimport { marketsDevScriptLib } from \"@src/markets/markets-script-dev-lib\";\r\nimport { Suspense, use } from \"react\";\r\n\r\nexport default function MarketsDevSettingsPage() {\r\n    const { t } = useTranslation('homepage/pages/markets-dev-settings/content');\r\n    return (\r\n        <Suspense fallback={<div>{t(\"content.loadPageData\")}</div>}>\r\n            <Content pageData={marketsDevSettingsLoadDefData()} libInit={marketsDevScriptLib.init()} />\r\n        </Suspense>\r\n    )\r\n}\r\n\r\nfunction Content({ pageData, libInit }: { pageData: Promise<IPageData>, libInit: Promise<void> }) {\r\n\r\n    const { t } = useTranslation('homepage/pages/markets-dev-settings/content');\r\n    const data = use(pageData)\r\n    const dispatcher = new Dispatcher()\r\n    use(libInit)\r\n\r\n    async function onClick() {\r\n        const res = await getContacts();\r\n        console.log('on click res=', res);\r\n    }\r\n    return (\r\n        <AppPageDataWrapperShell\r\n            contextValue={data}\r\n            ContextProvider={MarketsDevSettingsContextProvider}\r\n        >\r\n            <AppbarContainer appbarProps={{ title: t(\"content.title\"), back: true, backDispatcher: dispatcher }}>\r\n                <Box>\r\n                    <Button onClick={onClick}>script</Button>\r\n                </Box>\r\n                <MarketsDevSettingsContent />\r\n            </AppbarContainer>\r\n        </AppPageDataWrapperShell>\r\n    )\r\n}\r\n\r\n\r\nfunction temp(id: string) {\r\n    const x = `\r\n\r\ncontactsPermission.permission = \"android.permission.READ_CONTACTS\";\r\n    var permissions = [contactsPermission];\r\n    var result = {\r\n      permissions: permissions,\r\n      permissionDenied: [],\r\n      permissionsSuccessed: [],\r\n      error: null,\r\n      data: null,\r\n      warning: null,\r\n      info: null,\r\n      isSuccess:false,\r\n    };\r\n\r\n    com.fanfanlo.lib.permissions.PermissionActivity.requestPermissions(context, permissions, true, \"SOS-读取联系人\", onCheckPermissionsCallback);\r\n    \r\n    function missionFailed(){\r\n      webViewJs.callJsEvent(\"${id}-missionFailed\", result, ${id});\r\n      missionComplete();\r\n    }\r\n    \r\n    function missionSuccess(){\r\n      webViewJs.callJsEvent(\"${id}-missionSuccess\", result, ${id});\r\n      missionComplete();\r\n    }\r\n\r\n    function missionComplete(){\r\n      webViewJs.callJsEvent(\"${id}-missionComplete\", result, ${id});\r\n    }\r\n    function onCheckPermissionsCallback(resultMap){\r\n      for(var i = 0; i < permissions.size(); i++){\r\n        var permissionInfo = permissions.get(i);\r\n        var permission = permissionInfo.permission;\r\n        if((permission in resultMap && resultMap[permission] == true) || permissionInfo.required == false)continue;\r\n        result.error = {\r\n          message:\"permission denied\",\r\n          extra:permissionInfo\r\n        }\r\n        missionFailed();\r\n        return;\r\n      }\r\n      runCodeAfterPermissionsAccess();\r\n    }\r\n    \r\n    function runCodeAfterPermissionsAccess(){\r\n      result.isSuccess = true;\r\n      missionSuccess();\r\n    }\r\n    \\`{isOk:\"true\"}\\`\r\n`\r\n}\r\n\r\n\r\nfunction createReadContactsScript(id: string) {\r\n    return `\r\n    var Manifest = Packages.android.Manifest;\r\n    var context = com.fanfanlo.lib.mc.LibMainModel.instance.application;\r\n    var contactsPermission = new Packages.com.fanfanlo.lib.permissions.PermissionRequest(\"android.permission.READ_CONTACTS\", true, null, null, null);\r\n// contactsPermission.permission = \"android.permission.READ_CONTACTS\";\r\n\r\n    var permissions = [contactsPermission];\r\n    var result = {\r\n      permissions: permissions,\r\n      permissionDenied: [],\r\n      permissionsSuccessed: [],\r\n      error: null,\r\n      data: null,\r\n      warning: null,\r\n      info: null,\r\n      isSuccess:false,\r\n    };\r\n    \r\n    com.fanfanlo.lib.permissions.PermissionActivity.requestPermissions(context, permissions, true, \"SOS-读取联系人\", onCheckPermissionsCallback);\r\n\r\n    function missionFailed(){\r\n        webViewJs.callJsEvent(\"${id}-missionFailed\", result, \"${id}\");\r\n        missionComplete();\r\n      }\r\n      \r\n      function missionSuccess(){\r\n        webViewJs.callJsEvent(\"${id}-missionSuccess\", result, \"${id}\");\r\n        missionComplete();\r\n      }\r\n  \r\n      function missionComplete(){\r\n        webViewJs.callJsEvent(\"${id}-missionComplete\", result, \"${id}\");\r\n      }\r\n      function onCheckPermissionsCallback(resultMap){\r\n        for(var i = 0; i < permissions.length; i++){\r\n          var permissionInfo = permissions[i];\r\n          var permission = permissionInfo.permission;\r\n          if(resultMap.get(permission) == true)continue;\r\n          if(permissionInfo.required == false)continue;\r\n          result.error = {\r\n            message:\"permission denied\",\r\n            extra:{\r\n                \"resultMap\":resultMap,\r\n                \"permission\":permission,\r\n                permissionInfo:permissionInfo\r\n            }\r\n          }\r\n          missionFailed();\r\n          return;\r\n        }\r\n        runCodeAfterPermissionsAccess();\r\n      }\r\n      \r\n      function runCodeAfterPermissionsAccess(){\r\n        result.isSuccess = true;\r\n        readContacts();\r\n        missionSuccess();\r\n      }\r\n\r\n      function readContacts(){\r\n        var contentResolver = com.fanfanlo.lib.mc.LibMainModel.instance.application.getContentResolver();\r\n        var ContactsContract = Packages.android.provider.ContactsContract;\r\n        var cursor = contentResolver.query(\r\n        ContactsContract.Contacts.CONTENT_URI,\r\n        null,\r\n        null,\r\n        null,\r\n        null\r\n        );\r\n\r\n        var contactList = [];\r\n        if (cursor !== null && cursor.moveToFirst()) {\r\n        var nameIndex = cursor.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME);\r\n        var idIndex = cursor.getColumnIndex(ContactsContract.Contacts._ID);\r\n\r\n        do {\r\n            var contactName = cursor.getString(nameIndex);\r\n            var contactId = cursor.getString(idIndex);\r\n\r\n            // 查询电话号码\r\n            let phone = null;\r\n            var hasPhoneNumberIndex = cursor.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER);\r\n            var hasPhoneNumber = cursor.getInt(hasPhoneNumberIndex);\r\n            if (hasPhoneNumber > 0) {\r\n            var phoneCursor = contentResolver.query(\r\n                ContactsContract.CommonDataKinds.Phone.CONTENT_URI,\r\n                null,\r\n                ContactsContract.CommonDataKinds.Phone.CONTACT_ID + \" = ?\",\r\n                [contactId],\r\n                null\r\n            );\r\n\r\n            if (phoneCursor !== null && phoneCursor.moveToFirst()) {\r\n                var phoneIndex = phoneCursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);\r\n                phone = phoneCursor.getString(phoneIndex);\r\n                phoneCursor.close();\r\n            }\r\n            }\r\n\r\n            contactList.push({\r\n            name: contactName,\r\n            phone: phone,\r\n            });\r\n\r\n        } while (cursor.moveToNext());\r\n\r\n        cursor.close();\r\n        }\r\n\r\n        result.data = {contactList};\r\n        var json = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson(result);\r\n        console.log(json);\r\n      }\r\n    `\r\n}\r\n\r\ninterface IPermission{\r\n    permission:string\r\n    required:boolean\r\n    reason:string\r\n    denyInfo:string\r\n    externalKey:string\r\n}\r\ninterface IErorr{\r\n    message:string,\r\n    extra:{\r\n        \"resultMap\":Record<string, boolean>,\r\n        \"permission\":string,\r\n        permissionInfo:IPermission\r\n    }\r\n  }\r\n\r\n  interface IData{\r\n    contactList:IContact[]\r\n  }\r\n  export interface IReadContactsResult {\r\n    permissions?: IPermission[];\r\n    permissionDenied?: IPermission[];\r\n    permissionsSuccessed?: IPermission[];\r\n    data?: IData;\r\n    isSuccess: boolean;\r\n    error?:IErorr\r\n  }\r\n  \r\n  export interface IContact {\r\n    name: string;\r\n    phone?: string;\r\n  }\r\n  \r\nexport async function getContacts() {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        const id = '@fanfanlo/scripts/script001/get-contacts'\r\n        const conf: IScriptConf = {\r\n            bridgeId: id,\r\n            scriptId: id,\r\n            forceStopTime: 1000 * 60 * 20,\r\n            onlyRunSingle: true,\r\n            injects: [\"webViewJs\", \"console\"],\r\n            script: createReadContactsScript(id)\r\n\r\n        }\r\n        function onMessage(event: { type: string, data: IReadContactsResult }) {\r\n            console.log('llllllllllllllllllllllllllaaaddd', event)\r\n            switch (event.type) {\r\n                case \"@fanfanlo/scripts/script001/get-contacts-missionSuccess\":\r\n                    resolve(event.data);\r\n                    break;\r\n                case \"@fanfanlo/scripts/script001/get-contacts-missionSuccess\":\r\n                    reject(event.data);\r\n                    break;\r\n                case \"@fanfanlo/scripts/script001/get-contacts-missionComplete\":\r\n                    window.removeEventListener(\"message\", onMessage);\r\n                    break;\r\n            }\r\n        }\r\n        window.addEventListener('message', onMessage)\r\n        const res = autoWebViewJs.callScriptByConf(conf)\r\n        console.log('getContacts_fn res=', res)\r\n    })\r\n}","export enum ScriptType {\r\n    // 只有一个脚本执行文件，它只在脚本列表里显示。\r\n    // 如果要修改或者配置参数，它可以嵌入到自己的代码里\r\n    // 或者提供新的页面路径，用router的方式打开\r\n    // 例如router.go({url:'/script-setting', script:'function(){//code is here}', pagePath:'/all-script-setting/#your-namespace/script/script001'})\r\n    // all-script-setting所有第三方统一页面\r\n    // your-namespace 第三方自己的命名空间\r\n    // url 第三方自己的js文件url，它和script二选一，优先script。\r\n    // script 第三方自己纯代码的脚本\r\n    // url可以设置为实时更新版本，script可以作为stable版本使用。\r\n    // script001 第三方自己的脚本名称\r\n    // pagePath可以挂载到你指定的路径下\r\n    Script = 'script',\r\n    Market = 'market'\r\n}\r\nexport enum WatchResourceType {\r\n    // 这是一个js文件，加载后直接套在iframe里用即可\r\n    Js = 'js',\r\n    // 这是一个html文件，直接当html加载到iframe里即可.\r\n    Html = 'html'\r\n}\r\n\r\nexport enum IMarketDevConnectEventType{\r\n    getAllScripts = 'getAllScripts'\r\n}\r\n// client用socket向server发送的消息，也就是安卓端或者是安卓端的网页向server发送的消息\r\nexport enum IMarketDevClientEmitEventType{\r\n    init = 'init'\r\n}\r\n// server用socket向安卓端发送的消息（本地调试也可以认为是向安卓的网页发送消息）\r\nexport enum IMarketDevServerEventType{\r\n    update = 'update',\r\n}\r\n\r\n// export interface IMarketDevFileUpdateEventData{\r\n//     filePath:string,\r\n//     conf:IClientWatchFile\r\n// }\r\n\r\nexport interface IMarketDevFileUpdateEvent extends IMarketDevEvent<IAndroidWatchFile>{\r\n    type: IMarketDevServerEventType.update,\r\n    data:IAndroidWatchFile\r\n}\r\n\r\nexport interface IMarketDevGetAllEventData{\r\n    resources:IAndroidWatchFile[]\r\n    htmls:IAndroidWatchFile[]\r\n}\r\nexport interface IMarketDevGetAllEvent extends IMarketDevEvent<IMarketDevGetAllEventData>{\r\n    type: IMarketDevConnectEventType.getAllScripts,\r\n    data:IMarketDevGetAllEventData\r\n}\r\nexport type IMarketDevEventType = IMarketDevConnectEventType | IMarketDevClientEmitEventType | IMarketDevServerEventType;\r\nexport interface IMarketDevEvent<T>{\r\n    type: IMarketDevEventType,\r\n    data:T\r\n}\r\ntype NamespaceType = string;\r\nexport interface IScriptData{\r\n    ns:NamespaceType;\r\n    name:string;\r\n    version?:string;\r\n    url?:string;\r\n    content?:string;\r\n    summary?:string;\r\n    description?:string;\r\n    doc?:string;\r\n    docType?:string\r\n    id?:string\r\n}\r\nexport interface IScriptFile extends IScriptData{\r\n\r\n    // 命名空间 用于识别唯一对象\r\n    // 每个用户用自己的用户名做命名空间\r\n    // 例如\r\n    // 0xFF336699/e-commerce\r\n    // ns:NamespaceType\r\n    resourceType:WatchResourceType\r\n    scriptType:ScriptType\r\n    // 通过网络加载的路径\r\n    // url?:string;\r\n}\r\n\r\nexport interface IClientWatchFile extends IScriptFile{\r\n    // 本地加载的路径\r\n    path:string;\r\n    //是否是ui模式输出，如果是ui模式输出则需要export {ScriptItem, MarketItem, MarketPage}当中之一或全部。\r\n    // isUi:boolean\r\n}\r\nexport interface IClientScriptConf extends IClientWatchFile{\r\n}\r\n\r\nexport interface IClientHtmlConf extends IClientWatchFile{\r\n    resourcesPath:string\r\n    resourcesUrl:string\r\n}\r\n\r\nexport interface IAndroidWatchFile{\r\n    client:IClientWatchFile\r\n    content:string\r\n}\r\n\r\n// 脚本文件map，这里是打散的，并没有按照开发者的ns分类，而是按照文件名分类\r\n// 也就是文件名当作分类了。开发者有个ns，但是一个开发者可以开发n个market\r\n// 所以用开发者的ns做限定是不够用的，现在想的是开发者ns+market or script做market的限定\r\n// 所以这个ns应该是：\r\n// `${developerNs}/markets/${market}`\r\n// `${developerNs}/markets/${market}/${script}`\r\n// `${developerNs}/scripts/${script}`\r\n// 这种格式，回头可以用分段的方式来截取对象\r\nexport type ScriptMap = Record<NamespaceType, IAndroidWatchFile>;","import { storeUtils, toProxy } from \"@fanfanlo\";\r\n\r\nexport interface ISocketSettingData{\r\n    //如果点击开始链接了，那就保持链接，这样需要注意不在开发环境时会不停重连。\r\n    keepConnect:boolean;\r\n    url:string;\r\n}\r\n\r\nasync function createDefSocketSettingData():Promise<ISocketSettingData>{\r\n    const data =  {\r\n        keepConnect:false,\r\n        url:\"\"     \r\n     }\r\n     const res = await storeUtils.getNamespaceStoreWithData('market-dev-socket-setting', {defData:data})\r\n     return res.data;\r\n}\r\n\r\nexport async function getMarketDevSocketSettingData():Promise<ISocketSettingData>{\r\n    return await createDefSocketSettingData()\r\n}","import { IFrameHtmlBuilderOptions } from \"@fanfanlo\";\n\nfunction createHtml(script: string, opts?:IFrameHtmlBuilderOptions) {\n    return `<html>\n    <head>\n    <script type=\"importmap\">\n  {\n    \"imports\": {\n      \"react\": \"https://esm.sh/react@19\",\n      \"react-dom/client\": \"https://esm.sh/react-dom@19/client\"\n    }\n  }\n</script>\n        <script>\n                const IFRAME_ID = '${opts?.iframeId}';\n                window.IFRAME_ID = '${opts?.iframeId}';\n                \n            var autoWebViewJs = window.autoWebViewJs = window.parent.window.autoWebViewJs;\n            autoWebViewJs = window.parent.window.autoWebViewJs;\n            var callScript = window.callScript = autoWebViewJs.callScript;\n            var callScriptByConf = window.callScriptByConf = autoWebViewJs.callScriptByConf;\n            var isRealInAndroid = window.isRealInAndroid;\n            // var storeUtilsConf = window.storeUtilsConf = window.parent.window.storeUtilsConf;\n            var storeUtilsConf = window.storeUtilsConf = {\n                ns:{},\n                read:window.parent.window.storeUtilsConf.read,\n                write:window.parent.window.storeUtilsConf.write   \n            }\n        </script>\n        <title>droid lego</title>\n        <style>html, body{margin-left:-0px;padding:0;\n        background-color: white;}</style>\n    </head>\n    <body>\n        <div id=\"app\"></div>\n        <script>${script}</script>\n        <script>\n                // const IFRAME_ID = '${opts?.iframeId}';\n                function notifyResize() {\n                    const body = document.body;\n                    const html = document.documentElement;\n                    \n                    // 获取实际内容高度（取最大值）\n                    const height = Math.max(\n                        body.scrollHeight,\n                        body.offsetHeight,\n                        html.scrollHeight,\n                        html.offsetHeight\n                    );\n                    \n                    // 获取实际内容宽度\n                    const width = Math.max(\n                        body.scrollWidth,\n                        body.offsetWidth,\n                        html.scrollWidth,\n                        html.offsetWidth\n                    );\n                    \n                    // 发送消息给父窗口\n                    window.parent.postMessage({\n                        type: 'resize',\n                        iframeId: IFRAME_ID,\n                        height,\n                        width\n                    }, '*');\n                }\n                \n                // 监听窗口大小变化\n                window.addEventListener('resize', notifyResize);\n                \n                // 监听DOMContentLoaded，确保DOM加载完毕后调整大小\n                document.addEventListener('DOMContentLoaded', notifyResize);\n                \n                // 监听load事件，确保所有资源加载完毕后调整大小\n                window.addEventListener('load', notifyResize);\n                \n                // 创建MutationObserver监听DOM变化\n                const observer = new MutationObserver(notifyResize);\n                observer.observe(document.documentElement, {\n                    childList: true,\n                    subtree: true,\n                    attributes: true,\n                    characterData: true\n                });\n                \n                // 监听来自父窗口的消息，处理请求重新调整大小的消息\n                window.addEventListener('message', function(event) {\n                    if (event.data && event.data.type === 'requestResize') {\n                        // 主动触发一次尺寸计算和发送\n                        notifyResize();\n                    }\n                });\n                \n                // 初始化大小\n                notifyResize();\n        </script>\n    </body>\n</html>`\n}\n\nfunction mergeHtml(html:string, opts?:IFrameHtmlBuilderOptions){\n    let h = html;\n    if(!h.includes('<body')){\n        h = `<body>${h}</body>`\n    }\n    if(!h.includes('<html')){\n        h = `<html>${h}</html>`\n    }\n    if(!h.includes('<head')){\n        h = h.replace('<html>', '<html><head></head>')\n    }\n    h = h.replace('<head>', `<head><script>\n                const IFRAME_ID = '${opts?.iframeId}';\n                window.IFRAME_ID = '${opts?.iframeId}';\n                \n            var autoWebViewJs = window.autoWebViewJs = window.parent.window.autoWebViewJs;\n            autoWebViewJs = window.parent.window.autoWebViewJs;\n            var callScript = window.callScript = autoWebViewJs.callScript;\n            var callScriptByConf = window.callScriptByConf = autoWebViewJs.callScriptByConf;\n            var isRealInAndroid = window.isRealInAndroid;\n            // var storeUtilsConf = window.storeUtilsConf = window.parent.window.storeUtilsConf;\n            var storeUtilsConf = window.storeUtilsConf = {\n                ns:{},\n                read:window.parent.window.storeUtilsConf.read,\n                write:window.parent.window.storeUtilsConf.write   \n            }\n        </script>\n        \n        <style>html, body{margin-left:-0px;padding:0;\n        background-color: white;}</style>`);\n\n    h = h.replace(`</body>`, `\n        \n        <script>\n                function notifyResize() {\n                    const body = document.body;\n                    const html = document.documentElement;\n                    \n                    // 获取实际内容高度（取最大值）\n                    const height = Math.max(\n                        body.scrollHeight,\n                        body.offsetHeight,\n                        html.scrollHeight,\n                        html.offsetHeight\n                    );\n                    \n                    // 获取实际内容宽度\n                    const width = Math.max(\n                        body.scrollWidth,\n                        body.offsetWidth,\n                        html.scrollWidth,\n                        html.offsetWidth\n                    );\n                    \n                    // 发送消息给父窗口\n                    window.parent.postMessage({\n                        type: 'resize',\n                        iframeId: IFRAME_ID,\n                        height,\n                        width\n                    }, '*');\n                }\n                \n                // 监听窗口大小变化\n                window.addEventListener('resize', notifyResize);\n                \n                // 监听DOMContentLoaded，确保DOM加载完毕后调整大小\n                document.addEventListener('DOMContentLoaded', notifyResize);\n                \n                // 监听load事件，确保所有资源加载完毕后调整大小\n                window.addEventListener('load', notifyResize);\n                \n                // 创建MutationObserver监听DOM变化\n                const observer = new MutationObserver(notifyResize);\n                observer.observe(document.documentElement, {\n                    childList: true,\n                    subtree: true,\n                    attributes: true,\n                    characterData: true\n                });\n                \n                // 监听来自父窗口的消息，处理请求重新调整大小的消息\n                window.addEventListener('message', function(event) {\n                    if (event.data && event.data.type === 'requestResize') {\n                        // 主动触发一次尺寸计算和发送\n                        notifyResize();\n                    }\n                });\n                \n                // 初始化大小\n                notifyResize();\n        </script>\n        </body>`);\n        console.log('hhhhhhhhhhhhh=', h);\n    return h;\n}\nasync function createHtmlByUrl(url: string, opts?:IFrameHtmlBuilderOptions) {\n    const res = await fetch(url);\n    const content = await res.text();\n    return createHtml(content, opts);\n}\nexport const marketHtmlUtils = {\n    createHtml,\n    createHtmlByUrl,\n    mergeHtml\n}","const p = () => typeof window < \"u\", E = () => window.self !== window.top, b = (e) => e instanceof HTMLIFrameElement, M = (e) => {\n  window.document.readyState === \"complete\" ? e() : window.addEventListener(\"load\", e);\n}, T = (e, t) => {\n  t(), e.addEventListener(\"load\", t);\n}, C = (e, t) => {\n  var o, i;\n  const n = ((o = e.contentWindow) == null ? void 0 : o.document.readyState) === \"complete\";\n  return e.src !== \"about:blank\" && ((i = e.contentWindow) == null ? void 0 : i.location.href) !== \"about:blank\" && n ? t() : e.addEventListener(\"load\", t);\n}, B = () => ({ offsetSize: 0, checkOrigin: !0, enableLegacyLibSupport: !1 }), k = (e) => {\n  try {\n    return new URL(e.src).origin === window.location.origin;\n  } catch {\n    return !1;\n  }\n}, D = (e) => {\n  try {\n    const t = new URL(e.src).origin;\n    if (t !== \"about:blank\")\n      return t;\n  } catch {\n  }\n  return null;\n}, W = (e) => (Object.keys(e).forEach((t) => e[t] === void 0 && delete e[t]), e), L = (e) => {\n  const { height: t, width: n } = e.getBoundingClientRect();\n  return { height: Math.ceil(t), width: Math.ceil(n) };\n}, g = (e, t) => e ? t ? e.querySelector(t) : e.documentElement : null, I = (e, t) => {\n  e && (t.bodyPadding && (e.body.style.padding = t.bodyPadding), t.bodyMargin && (e.body.style.margin = t.bodyMargin));\n}, h = (e) => e <= 100 ? 100 : e <= 120 ? 1e3 : 1e4, A = () => \"[iFrameSizer]ID:0:false:false:32:true:true::auto:::0:false:child:auto:true:::true:::false\";\nfunction H(e) {\n  if (typeof e.data != \"string\" || !e.data.startsWith(\"[iFrameSizer]\") || !e.data.endsWith(\"mutationObserver\") && !e.data.endsWith(\"resizeObserver\"))\n    return null;\n  const [t, n] = e.data.split(\":\"), r = +n;\n  return r > 0 ? r : null;\n}\nconst z = q();\nlet f = [];\nconst K = (e, t) => {\n  if (!p())\n    return [];\n  const n = { ...B(), ...W(e ?? {}) }, r = P(t), o = x(n, r);\n  return r.map((i) => {\n    const s = {\n      iframe: i,\n      settings: n,\n      interactionState: { isHovered: !1 },\n      initContext: { isInitialized: !1, retryAttempts: 0 }\n    }, a = F(s, o);\n    return f.push(s), {\n      unsubscribe: () => {\n        a(), f = f.filter((d) => d.iframe !== i);\n      }\n    };\n  });\n};\nfunction P(e) {\n  return typeof e == \"string\" ? Array.from(document.querySelectorAll(e)).filter(b) : e ? b(e) ? [e] : [] : Array.from(document.getElementsByTagName(\"iframe\"));\n}\nfunction x(e, t) {\n  if (Array.isArray(e.checkOrigin))\n    return e.checkOrigin;\n  if (!e.checkOrigin)\n    return [];\n  const n = [];\n  for (const r of t) {\n    const o = D(r);\n    o && n.push(o);\n  }\n  return n;\n}\nfunction F(e, t) {\n  const n = k(e.iframe) ? U(e) : N(e, t), r = $(e);\n  return () => {\n    n(), r();\n  };\n}\nfunction N(e, t) {\n  const {\n    iframe: n,\n    initContext: r,\n    settings: { checkOrigin: o, enableLegacyLibSupport: i, targetElementSelector: s, bodyPadding: a, bodyMargin: d }\n  } = e, u = (c) => {\n    var y;\n    const S = !o || t.includes(c.origin);\n    if (!(!(n.contentWindow === c.source) || !S)) {\n      if (((y = c.data) == null ? void 0 : y.type) === \"iframe-resized\") {\n        const { height: l } = c.data;\n        l && m({ newHeight: l, registeredElement: e });\n        return;\n      }\n      if (i) {\n        const l = H(c);\n        l !== null && m({ newHeight: l, registeredElement: e });\n        return;\n      }\n    }\n  };\n  window.addEventListener(\"message\", u);\n  const R = i ? A() : { type: \"iframe-child-init\", targetElementSelector: s, bodyPadding: a, bodyMargin: d }, w = () => {\n    T(n, () => {\n      var c;\n      return (c = n.contentWindow) == null ? void 0 : c.postMessage(R, \"*\");\n    }), r.retryAttempts++, r.retryTimeoutId = window.setTimeout(w, h(r.retryAttempts));\n  };\n  return w(), () => window.removeEventListener(\"message\", u);\n}\nfunction U(e) {\n  const { iframe: t, settings: n } = e, { targetElementSelector: r } = n;\n  let o = 0;\n  const i = () => {\n    const s = g(t.contentDocument, r);\n    if (!t.contentDocument || !s)\n      return o++, setTimeout(i, h(o));\n    I(t.contentDocument, n), z().observe(s);\n  };\n  return C(t, i), () => {\n    const s = g(t.contentDocument, r);\n    s && z().unobserve(s), t.removeEventListener(\"load\", i);\n  };\n}\nfunction $({ iframe: e, interactionState: t }) {\n  const n = () => {\n    t.isHovered = !0;\n  }, r = () => {\n    t.isHovered = !1;\n  };\n  return e.addEventListener(\"mouseenter\", n), e.addEventListener(\"mouseleave\", r), () => {\n    e.removeEventListener(\"mouseenter\", n), e.removeEventListener(\"mouseleave\", r);\n  };\n}\nfunction q() {\n  let e = null;\n  return () => {\n    if (!e) {\n      const t = ({ target: n }) => {\n        const r = f.find(({ iframe: d }) => d.contentDocument === n.ownerDocument);\n        if (!r)\n          return;\n        const { iframe: o, settings: i } = r, s = g(o.contentDocument, i.targetElementSelector);\n        if (!s)\n          return;\n        const { height: a } = L(s);\n        a && m({ newHeight: a, registeredElement: r });\n      };\n      e = new ResizeObserver((n) => n.forEach(t));\n    }\n    return e;\n  };\n}\nfunction m({ registeredElement: e, newHeight: t }) {\n  var u;\n  const { iframe: n, settings: r, interactionState: o, initContext: i } = e;\n  if (i.isInitialized || (i.isInitialized = !0, clearTimeout(i.retryTimeoutId)), ((u = r.onBeforeIframeResize) == null ? void 0 : u.call(r, { iframe: n, settings: { ...r }, observedHeight: t })) === !1)\n    return;\n  const s = n.getBoundingClientRect(), a = t + r.offsetSize;\n  if (n.style.height = `${a}px`, !r.onIframeResize)\n    return;\n  const d = {\n    iframe: n,\n    settings: { ...r },\n    interactionState: { ...o },\n    previousRenderState: { rect: s },\n    nextRenderState: { rect: n.getBoundingClientRect() }\n  };\n  r.onIframeResize(d);\n}\nconst V = G();\nlet v = !1;\n_();\nfunction _() {\n  !p() || !E() || window.addEventListener(\"message\", (e) => {\n    var t;\n    ((t = e.data) == null ? void 0 : t.type) === \"iframe-child-init\" && M(() => O(e));\n  });\n}\nfunction O(e, t = 0) {\n  const { targetElementSelector: n, bodyPadding: r, bodyMargin: o } = e.data, i = g(document, n);\n  if (v || window.parent !== e.source)\n    return;\n  if (!i)\n    return setTimeout(() => O(e, t + 1), h(t));\n  I(document, { bodyMargin: o, bodyPadding: r });\n  const s = V();\n  s.disconnect(), s.observe(i), v = !0;\n}\nfunction G() {\n  let e = null;\n  return () => (e || (e = new ResizeObserver((t) => {\n    if (!t[0].target)\n      return;\n    const { height: n, width: r } = L(t[0].target), o = {\n      type: \"iframe-resized\",\n      width: r,\n      height: n\n    };\n    window.parent.postMessage(o, \"*\");\n  })), e);\n}\nconst Q = ({ previousRenderState: e, nextRenderState: t, iframe: n }) => {\n  document.activeElement === n && window.scrollBy(0, t.rect.bottom - e.rect.bottom);\n};\nexport {\n  K as initialize,\n  _ as initializeChildListener,\n  Q as updateParentScrollOnResize\n};\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/markets-dev-settings\",\n      function () {\n        return require(\"private-next-pages/markets-dev-settings/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/markets-dev-settings\"])\n      });\n    }\n  ","import { Dispatcher, isValidWebSocketURL, SocketConnectStatusEnum, toProxy } from \"@fanfanlo\";\r\nimport { IMarketDevConnectEventType, IMarketDevEvent } from \"@market/lib\";\r\nimport { getMarketDevSocketSettingData } from \"./market-dev-socket-setting-data\";\r\nconst dispatcher = new Dispatcher();\r\ninterface ISocketConnectInfo{\r\n    status:SocketConnectStatusEnum;\r\n    retryCount:number;\r\n}\r\n\r\nexport const socketConnectInfo:ISocketConnectInfo = toProxy({\r\n    status:SocketConnectStatusEnum.disconnected,\r\n    retryCount:0\r\n})\r\nlet ws:WebSocket|undefined;\r\nasync function connect(){\r\n    const url = (await getMarketDevSocketSettingData()).url\r\n    if(!isValidWebSocketURL(url)){\r\n        return;\r\n    }\r\n    socketConnectInfo.status = SocketConnectStatusEnum.connecting;\r\n    const w = ws = new WebSocket(url);\r\n    w.onopen = () => {\r\n        socketConnectInfo.status = SocketConnectStatusEnum.connected;\r\n        toGetAllScripts();\r\n    }\r\n    w.onclose = () => {\r\n        console.log('oscket on close', arguments)\r\n        socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n        checkNeedRetry();\r\n    }\r\n    w.onerror = () => {\r\n        console.log('socket onerror', arguments)\r\n        socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n        close();\r\n        checkNeedRetry();\r\n    }\r\n    w.onmessage = (e:MessageEvent) => {\r\n        try{\r\n            const event:IMarketDevEvent<any> = JSON.parse(e.data)\r\n            console.log('market dev socket onmessage', event.type)\r\n            dispatcher.dispatch(event.type, event.data)\r\n        }catch(e){\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    async function toGetAllScripts(){\r\n        const event = {type: IMarketDevConnectEventType.getAllScripts}\r\n        w.send(JSON.stringify(event));\r\n    }\r\n}\r\nfunction close(){\r\n    if(!ws)return;\r\n    ws.close();\r\n    ws = undefined;\r\n}\r\nasync function checkNeedRetry(){\r\n    const settingData = await getMarketDevSocketSettingData()\r\n    if(!settingData.keepConnect){\r\n        return;\r\n    }\r\n    socketConnectInfo.retryCount++;\r\n    setTimeout(()=>{\r\n        connect();\r\n    }, 1000 * 5)\r\n}\r\nfunction disconnect(){\r\n    if(ws){\r\n        ws.close();\r\n        ws = undefined;\r\n    }\r\n    socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n}\r\nexport const marketsDevSocket = {\r\n    connect,\r\n    disconnect,\r\n    socketConnectInfo,\r\n    dispatcher\r\n}\r\n","import { Dispatcher } from \"@fanfanlo\"\r\nimport { DispatcherUnsubscribe } from \"@fanfanlo\"\r\n\r\nconst dipsatcher = new Dispatcher()\r\ninterface IStaticModel{\r\n    dipsatcher:Dispatcher\r\n    screenLockCount:number\r\n    switchPage:()=>void\r\n    listenSwitchPage:(callback:()=>void)=>DispatcherUnsubscribe \r\n}\r\nexport const staticModel:IStaticModel = {\r\n    dipsatcher,\r\n    screenLockCount:0,\r\n    switchPage:async()=>{\r\n        dipsatcher.dispatch(\"switchPage\")\r\n        staticModel.screenLockCount = 0\r\n    },\r\n    listenSwitchPage:(callback:()=>void)=>{\r\n        return dipsatcher.addListener(\"switchPage\",callback)\r\n    }\r\n}   \r\n","import { PropsWithChildren } from \"react\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\nimport { useRouter } from \"next/router\";\r\n\r\n\r\nexport function PageTransition({ children }: PropsWithChildren) {\r\n    const router = useRouter()\r\n    return (\r\n\r\n        <AnimatePresence mode=\"sync\">\r\n            <motion.div\r\n                key={router.route}\r\n                initial={{ opacity: 0, y: 10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -110 }}\r\n                transition={{ duration: 0.3 }}\r\n            >\r\n                {children}\r\n            </motion.div>\r\n        </AnimatePresence>\r\n    )\r\n}","import { staticModel } from \"@app/static\";\r\nimport { Box } from \"@mui/material\";\r\nimport { useEffect } from \"react\";\r\nimport { PageTransition } from \"../motion\";\r\nlet idCount = 0\r\nexport function PageShell({children}:{children:React.ReactNode}){\r\n    const id = `app-shell-${idCount++}`\r\n    useEffect(()=>{\r\n        const box = document.querySelector(`#${id}`)\r\n        const unlisten = staticModel.listenSwitchPage(()=>{\r\n            if(!box)return\r\n        })\r\n        if(!box)return\r\n        box.addEventListener(\"click\",(e)=>{\r\n            if(staticModel.screenLockCount == 0)return\r\n            e.stopPropagation()\r\n            e.preventDefault()\r\n        })\r\n        return ()=>{\r\n            unlisten()\r\n        }\r\n    },[])\r\n    return (\r\n        <Box id={id}>\r\n            <PageTransition>\r\n                {children}  \r\n            </PageTransition>\r\n        </Box>\r\n    )\r\n}\r\n","import { AppBar, Box, Container, CssBaseline, Fab, Fade, Slide, Toolbar, Typography, useScrollTrigger } from \"@mui/material\";\r\nimport { PropsWithChildren, ReactNode } from \"react\";\r\n// import {AndroidPageContent} from \"../../\";\r\nimport { browserHistoryUtils, IDispatcher } from \"@fanfanlo\";\r\nimport KeyboardArrowLeft from '@mui/icons-material/KeyboardArrowLeft';\r\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\r\nimport * as React from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport { PageShell } from \"../app/PageShell\";\r\nimport shadows from \"@mui/material/styles/shadows\";\r\nimport AndroidPageContent from \"../page/AndroidPageContent\";\r\nimport { IAppBarBackAskEvent } from \"@app/static\";\r\nimport { ITitleI18nConf } from \"../page\";\r\ninterface Props {\r\n    /**\r\n     * Injected by the documentation to work in an iframe.\r\n     * You won't need it on your project.\r\n     */\r\n    window?: () => Window;\r\n    children?: React.ReactElement<unknown>;\r\n}\r\n\r\nfunction HideOnScroll(props: Props) {\r\n    const { children, window } = props;\r\n    // Note that you normally won't need to set the window ref as useScrollTrigger\r\n    // will default to window.\r\n    // This is only being set here because the demo is in an iframe.\r\n    const trigger = useScrollTrigger({\r\n        target: window ? window() : undefined,\r\n    });\r\n\r\n    return (\r\n        <Slide appear={false} direction=\"down\" in={!trigger}>\r\n            {children ?? <div />}\r\n        </Slide>\r\n    );\r\n}\r\nexport interface IAppbarProps extends PropsWithChildren {\r\n    title: ReactNode\r\n    back: boolean\r\n    backHandler?: () => boolean\r\n    backDispatcher?:IDispatcher\r\n    toolbar?:ReactNode\r\n    toolbarContent?:ReactNode\r\n}\r\nexport function Appbar({ title }: { title: ReactNode } & PropsWithChildren) {\r\n    return (\r\n\r\n        <AppBar color={\"inherit\"}>\r\n            <Toolbar>\r\n                <Typography variant=\"h6\" component=\"div\">\r\n                    {title}\r\n                </Typography>\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n}\r\n\r\ninterface IAppbarContainerProps extends PropsWithChildren {\r\n    appbarProps: IAppbarProps\r\n    titleConf?:ITitleI18nConf\r\n    reload?: boolean\r\n}\r\n\r\n// export interface IAppBarBackAskEvent{\r\n//     defaultPrevented:boolean\r\n// }\r\n\r\nfunction ScrollTop(props: Props) {\r\n    const { children, window } = props;\r\n    // Note that you normally won't need to set the window ref as useScrollTrigger\r\n    // will default to window.\r\n    // This is only being set here because the demo is in an iframe.\r\n    const trigger = useScrollTrigger({\r\n        target: window ? window() : undefined,\r\n        disableHysteresis: true,\r\n        threshold: 100,\r\n    });\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLDivElement>) => {\r\n        const anchor = (\r\n            (event.target as HTMLDivElement).ownerDocument || document\r\n        ).querySelector('#back-to-top-anchor');\r\n\r\n        if (anchor) {\r\n            anchor.scrollIntoView({\r\n                block: 'center',\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Fade in={trigger}>\r\n            <Box data-id=\"content-scroll-top-button\"\r\n                onClick={handleClick}\r\n                role=\"presentation\"\r\n                sx={{ position: 'fixed', bottom: 16, right: 16 }}\r\n            >\r\n                {children}\r\n            </Box>\r\n        </Fade>\r\n    );\r\n}\r\nexport function AppbarContainer(props: IAppbarContainerProps) {\r\n    const { children, appbarProps, titleConf, reload } = props;\r\n    const router = useRouter()\r\n    function handleBack(){\r\n        // 本想抽象成底层一个方法，但是考虑了一下router需要注入或者是一个callback，似乎像现在这样判断一下event也可以。回头继续观察一下吧。\r\n        const event = browserHistoryUtils.askHistoryBack()\r\n        if(event.defaultPrevented)return\r\n        if(appbarProps.backDispatcher){\r\n            const e:IAppBarBackAskEvent = {defaultPrevented:false}\r\n            appbarProps.backDispatcher.dispatch('back',e)\r\n            if(e.defaultPrevented)return\r\n        }\r\n        router.back()\r\n    }\r\n    return (\r\n        <PageShell>\r\n        <React.Fragment>\r\n            <CssBaseline />\r\n            <HideOnScroll {...props}>\r\n                <AppBar color=\"inherit\">\r\n                    {appbarProps.toolbar ? \r\n                    appbarProps.toolbar:\r\n                    <Toolbar>\r\n                        <KeyboardArrowLeft onClick={handleBack} />\r\n                        {appbarProps.title}\r\n                    </Toolbar>\r\n                    }\r\n                </AppBar>\r\n            </HideOnScroll>\r\n            <Toolbar id=\"back-to-top-anchor\" />\r\n            <Container sx={{padding:\"0\", marginTop:\"17px\"}}>\r\n                <AndroidPageContent titleConf={titleConf} reload={reload}>\r\n                    {children}\r\n                </AndroidPageContent>\r\n            </Container>\r\n\r\n            <ScrollTop {...props}>\r\n                <Fab size=\"small\" aria-label=\"scroll back to top\">\r\n                    <KeyboardArrowUpIcon />\r\n                </Fab>\r\n            </ScrollTop>\r\n        </React.Fragment>\r\n        </PageShell>\r\n    );\r\n}\r\n"],"names":["createContext","useContext","createTypedContext","Context","undefined","useTypedContext","value","Error","Provider","autoJsStoreUtils","storeUtils","toProxy","IMarketDevConnectEventType","IMarketDevServerEventType","WatchResourceType","marketsDevSocket","marketDevLibData","devLibInfo","getMarketScriptDataNsPrefix","createMarketScriptDataNsPath","ns","writeNsAllFiles","files","nsPath","oldFiles","read","name","Object","keys","index","indexOf","splice","content","write","removeFile","writeFile","readNsAllFiles","readFile","getAllMarkets","listenDev","dispatcher","addListener","getAllScripts","onGetAllScript","update","onFileUpdate","data","allMarketLibData","client","resourceType","Html","html","htmls","path","Js","resources","length","script","console","log","isInitialized","init","getNamespaceStoreWithData","defData","forceReset","marketsDevScriptLib","PropTypes","createStack","styled","useDefaultProps","Stack","createStyledComponent","slot","overridesResolver","props","styles","root","useThemeProps","inProps","propTypes","children","node","component","elementType","direction","oneOfType","oneOf","arrayOf","object","divider","spacing","number","string","sx","func","bool","useFlexGap","validator","loadI18nValue","isValidWebSocketURL","url","isURL","protocols","require_protocol","SocketConnectStatusEnum","getSocketConnectStatusEnumI18n","status","ContextWrapper","contextValue","ContextProvider","AppShell","AppPageDataWrapperShell","MarketsDevSettingsContextProvider","useMarketsDevSettingsContext","useProxyWatch","useTranslation","Box","Button","Checkbox","FormControlLabel","Grid2","TextField","useEffect","useState","URL","t","pageData","_setValue","socketSettingData","isWrong","setIsWrong","setValue","v","s","fullWidth","error","label","placeholder","helperText","variant","onChange","e","target","ConnectButton2","socketConnectInfo","buttonName","setButtonName","enabled","setEnabled","disconnected","connected","updateButtonName","connecting","disconnecting","onClick","connect","disconnect","disabled","KeepConnectCheckbox","keepConnect","control","checked","span","style","fontSize","color","CheckboxButtonGroup","container","size","DevSettings","IFrameReactContainer","useProxyWatchUpdates","marketHtmlUtils","createHtml","Script","resource","htmlBuilder","Scripts","map","MarketsDevSettingsContent","button","getMarketDevSocketSettingData","createDefPageData","dataImpl","marketsDevSettingsLoadDefData","AppbarContainer","autoWebViewJs","Dispatcher","Suspense","use","MarketsDevSettingsPage","fallback","div","Content","libInit","res","getContacts","appbarProps","title","back","backDispatcher","temp","id","x","createReadContactsScript","Promise","resolve","reject","conf","bridgeId","scriptId","forceStopTime","onlyRunSingle","injects","onMessage","event","type","window","removeEventListener","addEventListener","callScriptByConf","ScriptType","IMarketDevClientEmitEventType","createDefSocketSettingData","opts","iframeId","mergeHtml","h","includes","replace","createHtmlByUrl","fetch","text","retryCount","ws","w","WebSocket","onopen","toGetAllScripts","onclose","arguments","checkNeedRetry","onerror","close","onmessage","JSON","parse","dispatch","send","stringify","settingData","setTimeout","dipsatcher","staticModel","screenLockCount","switchPage","listenSwitchPage","callback","AnimatePresence","motion","useRouter","PageTransition","router","mode","initial","opacity","y","animate","exit","transition","duration","route","idCount","PageShell","box","document","querySelector","unlisten","stopPropagation","preventDefault","AppBar","Container","CssBaseline","Fab","Fade","Slide","Toolbar","Typography","useScrollTrigger","browserHistoryUtils","KeyboardArrowLeft","KeyboardArrowUpIcon","React","AndroidPageContent","HideOnScroll","trigger","appear","in","Appbar","ScrollTop","disableHysteresis","threshold","handleClick","anchor","ownerDocument","scrollIntoView","block","data-id","role","position","bottom","right","titleConf","reload","handleBack","askHistoryBack","defaultPrevented","Fragment","toolbar","padding","marginTop","aria-label"],"sourceRoot":"","ignoreList":[2,3,16]}